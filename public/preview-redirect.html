<!DOCTYPE html>
<html>
<head>
  <title>Redirecting...</title>
</head>
<body>
  <script>
    // This page handles preview redirects when production doesn't have the React code yet
    console.log('üîê [REDIRECT PAGE] Checking for preview redirect');
    
    // Check for preview URL in cookie or localStorage
    function getCookie(name) {
      const value = `; ${document.cookie}`;
      const parts = value.split(`; ${name}=`);
      if (parts.length === 2) return decodeURIComponent(parts.pop().split(';').shift());
      return null;
    }
    
    const previewUrl = getCookie('preview_redirect_url') || localStorage.getItem('preview_redirect_url');
    const currentHash = window.location.hash;
    const hasAuthHash = currentHash.includes('access_token') || currentHash.includes('code=');
    
    console.log('üîê [REDIRECT PAGE] Preview check:', {
      previewUrl,
      currentOrigin: window.location.origin,
      hasAuthHash,
      hashLength: currentHash.length,
      cookie: getCookie('preview_redirect_url'),
      localStorage: localStorage.getItem('preview_redirect_url')
    });
    
    if (previewUrl && window.location.origin !== previewUrl && hasAuthHash) {
      const redirectTo = `${previewUrl}${window.location.pathname}${currentHash}`;
      console.log('üîê [REDIRECT PAGE] ‚ö° REDIRECTING to preview:', redirectTo);
      
      // Clear cookie and localStorage
      document.cookie = 'preview_redirect_url=; path=/; max-age=0';
      localStorage.removeItem('preview_redirect_url');
      
      window.location.replace(redirectTo);
    } else {
      console.log('üîê [REDIRECT PAGE] No redirect needed, redirecting to root');
      // Redirect to root - React app will handle it
      window.location.replace('/');
    }
  </script>
</body>
</html>

